{"version":3,"file":"main-CshxKk12.js","sources":["../../ar-animation.js","../../image-tracker.js","../../main.js"],"sourcesContent":["// 移除Three.js依赖，只使用原生Canvas API\n// import * as THREE from 'three';\n\nexport class ARAnimation {\n    constructor() {\n        this.canvas = null;\n        this.isVisible = false;\n        this.isRunning = false;\n        this.targetPosition = { x: 0, y: 0 };\n        this.targetSize = { width: 100, height: 100 };\n        \n        // PNG逐帧动画相关 - 优化版本\n        this.frames = []; // 存储所有帧图片\n        this.currentFrame = 0; // 当前帧索引\n        this.frameCount = 0; // 总帧数\n        this.fps = 8; // 降低帧率到8fps，减少CPU使用\n        this.lastFrameTime = 0; // 上一帧时间\n        this.isLoaded = false; // 是否加载完成\n        \n        // 2D Canvas动画相关\n        this.ctx = null;\n        this.animationId = null;\n        \n        // 性能优化：预计算尺寸\n        this.cachedSizes = new Map();\n        \n        console.log('AR动画类初始化完成');\n    }\n\n    start(canvas, position, size) {\n        if (!canvas) return;\n        \n        console.log('启动AR动画...');\n        \n        this.canvas = canvas;\n        this.ctx = canvas.getContext('2d');\n        this.targetPosition = position || { x: 0, y: 0 };\n        this.targetSize = size || { width: 100, height: 100 };\n        \n        if (!this.isRunning) {\n            this.isRunning = true;\n            this.isVisible = true;\n            this.lastFrameTime = performance.now();\n            this.animate();\n        }\n        \n        console.log('AR动画已启动');\n    }\n\n    stop() {\n        console.log('停止AR动画...');\n        \n        this.isRunning = false;\n        this.isVisible = false;\n        \n        if (this.animationId) {\n            cancelAnimationFrame(this.animationId);\n            this.animationId = null;\n        }\n        \n        // 清除canvas\n        if (this.ctx && this.canvas) {\n            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        }\n        \n        console.log('AR动画已停止');\n    }\n\n    // 优化的逐帧动画循环\n    animate() {\n        if (!this.isRunning || !this.ctx || !this.canvas) return;\n        \n        const currentTime = performance.now();\n        const deltaTime = currentTime - this.lastFrameTime;\n        \n        // 根据帧率更新帧\n        if (deltaTime >= (1000 / this.fps)) {\n            this.currentFrame = (this.currentFrame + 1) % this.frameCount;\n            this.lastFrameTime = currentTime;\n        }\n        \n        // 清除之前的绘制\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        \n        // 绘制当前帧\n        this.drawCurrentFrame();\n        \n        // 继续动画循环\n        this.animationId = requestAnimationFrame(() => this.animate());\n    }\n\n    // 优化的绘制当前帧\n    drawCurrentFrame() {\n        if (!this.isLoaded || this.frames.length === 0) {\n            console.log('动画未加载完成，跳过绘制', {\n                isLoaded: this.isLoaded,\n                framesCount: this.frames.length,\n                currentFrame: this.currentFrame\n            });\n            return;\n        }\n        \n        const frame = this.frames[this.currentFrame];\n        if (!frame) {\n            console.log('当前帧不存在', {\n                currentFrame: this.currentFrame,\n                totalFrames: this.frameCount\n            });\n            return;\n        }\n        \n        // 使用缓存的尺寸计算\n        const drawInfo = this.getCachedDrawInfo(frame);\n        \n        // 绘制当前帧\n        this.ctx.drawImage(\n            frame, \n            drawInfo.x, \n            drawInfo.y, \n            drawInfo.width, \n            drawInfo.height\n        );\n        \n        // 调试信息：每10帧输出一次\n        if (this.currentFrame % 10 === 0) {\n            console.log('绘制动画帧', {\n                frame: this.currentFrame,\n                position: drawInfo,\n                frameSize: `${frame.width}x${frame.height}`\n            });\n        }\n    }\n\n    // 缓存绘制信息，避免重复计算\n    getCachedDrawInfo(frame) {\n        const cacheKey = `${frame.width}-${frame.height}-${this.targetSize.width}-${this.targetSize.height}`;\n        \n        if (this.cachedSizes.has(cacheKey)) {\n            return this.cachedSizes.get(cacheKey);\n        }\n        \n        // 计算绘制位置和大小\n        const centerX = this.targetPosition.x;\n        const centerY = this.targetPosition.y;\n        \n        // 使用更大的尺寸，确保动画足够大且清晰\n        const minSize = 120; // 稍微减小最小尺寸\n        const maxSize = Math.max(this.targetSize.width, this.targetSize.height);\n        const size = Math.max(minSize, maxSize * 1.0); // 减少缩放倍数\n        \n        // 计算帧的绘制位置和大小\n        const frameWidth = frame.width;\n        const frameHeight = frame.height;\n        const scale = Math.min(size / frameWidth, size / frameHeight);\n        const drawWidth = frameWidth * scale;\n        const drawHeight = frameHeight * scale;\n        \n        // 计算左上角位置\n        const drawX = centerX - drawWidth / 2;\n        const drawY = centerY - drawHeight / 2;\n        \n        // 边界检查，确保动画不会超出屏幕\n        const viewportWidth = window.innerWidth;\n        const viewportHeight = window.innerHeight;\n        \n        let finalX = Math.max(10, Math.min(drawX, viewportWidth - drawWidth - 10));\n        let finalY = Math.max(10, Math.min(drawY, viewportHeight - drawHeight - 10));\n        \n        const drawInfo = { x: finalX, y: finalY, width: drawWidth, height: drawHeight };\n        \n        // 缓存结果\n        this.cachedSizes.set(cacheKey, drawInfo);\n        \n        return drawInfo;\n    }\n\n    // 优化的PNG逐帧动画加载\n    loadFrames() {\n        return new Promise((resolve, reject) => {\n            const framePaths = [\n                '/images/GIF1.png',\n                '/images/GIF2.png',\n                '/images/GIF3.png',\n                '/images/GIF4.png'\n            ];\n            \n            let loadedCount = 0;\n            let errorCount = 0;\n            const totalFrames = framePaths.length;\n            \n            // 设置总体超时\n            const overallTimeout = setTimeout(() => {\n                if (loadedCount < totalFrames) {\n                    reject(new Error('动画加载超时'));\n                }\n            }, 3000);\n            \n            framePaths.forEach((path, index) => {\n                const img = new Image();\n                \n                // 设置单个图片加载超时\n                const timeout = setTimeout(() => {\n                    errorCount++;\n                    console.warn(`帧${index + 1}加载超时: ${path}`);\n                    \n                    if (errorCount === totalFrames) {\n                        clearTimeout(overallTimeout);\n                        reject(new Error('所有帧加载失败'));\n                    }\n                }, 2000);\n                \n                img.onload = () => {\n                    clearTimeout(timeout);\n                    this.frames[index] = img;\n                    loadedCount++;\n                    \n                    console.log(`帧${index + 1}加载成功: ${path}, 尺寸: ${img.width}x${img.height}`);\n                    \n                    if (loadedCount === totalFrames) {\n                        clearTimeout(overallTimeout);\n                        this.frameCount = totalFrames;\n                        this.isLoaded = true;\n                        console.log(`所有帧加载完成，共${totalFrames}帧`);\n                        resolve();\n                    }\n                };\n                \n                img.onerror = (error) => {\n                    clearTimeout(timeout);\n                    errorCount++;\n                    console.error(`帧${index + 1}加载失败:`, error);\n                    \n                    if (errorCount === totalFrames) {\n                        clearTimeout(overallTimeout);\n                        reject(new Error('所有帧加载失败'));\n                    }\n                };\n                \n                // 设置跨域属性\n                img.crossOrigin = 'anonymous';\n                img.src = path;\n            });\n        });\n    }\n\n    // 兼容旧版本的GIF加载方法\n    loadGif(gifPath) {\n        console.log('检测到GIF路径，自动切换到PNG逐帧动画模式');\n        return this.loadFrames();\n    }\n\n    // 兼容旧版本的方法\n    init() {\n        console.log('AR动画初始化完成');\n    }\n\n    showAnimation(position, size) {\n        this.start(null, position, size);\n    }\n\n    hideAnimation() {\n        this.stop();\n    }\n\n    update() {\n        // 这个方法保留用于兼容性\n    }\n\n    dispose() {\n        this.stop();\n        \n        // 清理帧图片\n        this.frames = [];\n        this.isLoaded = false;\n        \n        // 清理缓存\n        this.cachedSizes.clear();\n        \n        console.log('AR动画资源已清理');\n    }\n} ","export class ImageTracker {\n    constructor() {\n        this.lastDetection = null;\n        this.detectionTimeout = 500; // 增加到500ms，减少重复检测\n        this.templates = [];\n        this.threshold = 0.15; // 降低匹配阈值，提高检测灵敏度\n        this.debugMode = false;\n        this.lastDetectionTime = 0;\n        this.detectionInterval = 250; // 增加到250ms，大幅减少CPU使用\n        this.isInitialized = false;\n        \n        // 性能优化：缓存检测结果\n        this.detectionCache = new Map();\n        this.cacheTimeout = 1000; // 缓存1秒\n        \n        // 延迟初始化，减少启动时间\n        setTimeout(() => {\n            this.isInitialized = true;\n            console.log('图片追踪器延迟初始化完成');\n        }, 200); // 减少延迟时间\n    }\n\n    // 添加模板图片 - 进一步优化版本\n    addTemplate(imageUrl, name = 'template') {\n        return new Promise((resolve, reject) => {\n            const img = new Image();\n            img.crossOrigin = 'anonymous';\n            \n            // 设置加载超时\n            const timeout = setTimeout(() => {\n                reject(new Error('图片加载超时'));\n            }, 2000); // 减少超时时间\n            \n            img.onload = () => {\n                clearTimeout(timeout);\n                \n                // 优化canvas创建\n                const canvas = document.createElement('canvas');\n                const ctx = canvas.getContext('2d');\n                \n                // 进一步限制图片尺寸以提高性能\n                const maxSize = 150; // 减少最大尺寸\n                const scale = Math.min(maxSize / img.width, maxSize / img.height, 1);\n                canvas.width = img.width * scale;\n                canvas.height = img.height * scale;\n                \n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n                \n                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n                this.templates.push({\n                    name,\n                    imageData,\n                    width: canvas.width,\n                    height: canvas.height\n                });\n                \n                console.log(`模板图片 \"${name}\" 添加成功，尺寸: ${canvas.width}x${canvas.height}`);\n                resolve();\n            };\n            \n            img.onerror = (error) => {\n                clearTimeout(timeout);\n                console.error(`模板图片 \"${name}\" 加载失败:`, error);\n                reject(error);\n            };\n            \n            img.src = imageUrl;\n        });\n    }\n\n    // 优化的图片检测\n    async detect(ctx, width, height) {\n        try {\n            // 限制检测频率\n            const now = Date.now();\n            if (now - this.lastDetectionTime < this.detectionInterval) {\n                return this.lastDetection ? this.lastDetection.result : { detected: false };\n            }\n            this.lastDetectionTime = now;\n\n            // 检查缓存\n            const cacheKey = `${width}x${height}`;\n            const cachedResult = this.detectionCache.get(cacheKey);\n            if (cachedResult && now - cachedResult.timestamp < this.cacheTimeout) {\n                return cachedResult.result;\n            }\n\n            // 检查是否有有效的检测结果\n            if (this.lastDetection && \n                now - this.lastDetection.timestamp < this.detectionTimeout) {\n                return this.lastDetection.result;\n            }\n\n            // 获取当前帧的图像数据\n            const frameData = ctx.getImageData(0, 0, width, height);\n            \n            // 对每个模板进行匹配\n            for (const template of this.templates) {\n                const match = this.matchTemplateOptimized(frameData, template, width, height);\n                \n                if (match && match.confidence > this.threshold) {\n                    const result = {\n                        detected: true,\n                        type: 'image',\n                        name: template.name,\n                        position: match.position,\n                        size: match.size,\n                        confidence: match.confidence\n                    };\n                    \n                    // 缓存结果\n                    this.detectionCache.set(cacheKey, {\n                        timestamp: now,\n                        result: result\n                    });\n                    \n                    this.lastDetection = {\n                        timestamp: now,\n                        result: result\n                    };\n                    \n                    console.log(`✅ 检测到图片 \"${template.name}\"，匹配度: ${match.confidence.toFixed(3)}`);\n                    return result;\n                }\n            }\n\n            // 如果没有检测到图片，清除上次检测结果\n            if (this.lastDetection && \n                now - this.lastDetection.timestamp > this.detectionTimeout) {\n                this.lastDetection = null;\n            }\n\n            // 缓存未检测到结果\n            const noDetectionResult = { detected: false };\n            this.detectionCache.set(cacheKey, {\n                timestamp: now,\n                result: noDetectionResult\n            });\n\n            return noDetectionResult;\n\n        } catch (error) {\n            console.error('图片检测错误:', error);\n            return { detected: false };\n        }\n    }\n\n    // 优化的模板匹配算法\n    matchTemplateOptimized(frameData, template, frameWidth, frameHeight) {\n        const templateWidth = template.width;\n        const templateHeight = template.height;\n        \n        // 如果模板太大，跳过\n        if (templateWidth > frameWidth || templateHeight > frameHeight) {\n            return null;\n        }\n\n        let bestMatch = null;\n        let bestConfidence = 0;\n\n        // 增加搜索步长以提高性能\n        const step = Math.max(3, Math.floor(Math.min(templateWidth, templateHeight) / 20));\n        \n        // 限制搜索范围，只搜索中心区域\n        const searchMargin = Math.min(80, Math.floor(Math.min(frameWidth, frameHeight) * 0.08));\n        const startX = searchMargin;\n        const startY = searchMargin;\n        const endX = frameWidth - templateWidth - searchMargin;\n        const endY = frameHeight - templateHeight - searchMargin;\n        \n        // 使用更少的采样点\n        const maxSamples = 100; // 限制最大采样数\n        let sampleCount = 0;\n        \n        for (let y = startY; y <= endY && sampleCount < maxSamples; y += step) {\n            for (let x = startX; x <= endX && sampleCount < maxSamples; x += step) {\n                sampleCount++;\n                \n                const confidence = this.calculateSimilarityFast(\n                    frameData, template.imageData,\n                    x, y, frameWidth,\n                    0, 0, templateWidth,\n                    templateWidth, templateHeight\n                );\n\n                if (confidence > bestConfidence) {\n                    bestConfidence = confidence;\n                    bestMatch = {\n                        position: { x, y },\n                        size: { width: templateWidth, height: templateHeight },\n                        confidence\n                    };\n                    \n                    // 如果找到很好的匹配，提前退出\n                    if (confidence > 0.8) {\n                        return bestMatch;\n                    }\n                }\n            }\n        }\n\n        return bestMatch;\n    }\n\n    // 快速相似度计算\n    calculateSimilarityFast(frameData, templateData, frameX, frameY, frameWidth, \n                           templateX, templateY, templateWidth, width, height) {\n        let totalDiff = 0;\n        let totalPixels = 0;\n\n        // 使用更少的采样点进行计算\n        const sampleStep = Math.max(1, Math.floor(Math.min(width, height) / 10));\n        \n        for (let y = 0; y < height; y += sampleStep) {\n            for (let x = 0; x < width; x += sampleStep) {\n                const frameIndex = ((frameY + y) * frameWidth + (frameX + x)) * 4;\n                const templateIndex = ((templateY + y) * templateWidth + (templateX + x)) * 4;\n\n                // 只计算RGB差异，忽略Alpha通道\n                const rDiff = Math.abs(frameData.data[frameIndex] - templateData.data[templateIndex]);\n                const gDiff = Math.abs(frameData.data[frameIndex + 1] - templateData.data[templateIndex + 1]);\n                const bDiff = Math.abs(frameData.data[frameIndex + 2] - templateData.data[templateIndex + 2]);\n\n                totalDiff += (rDiff + gDiff + bDiff) / 3;\n                totalPixels++;\n            }\n        }\n\n        // 计算相似度（0-1，1表示完全匹配）\n        if (totalPixels === 0) return 0;\n        const averageDiff = totalDiff / totalPixels;\n        return Math.max(0, 1 - averageDiff / 255);\n    }\n\n    // 原始模板匹配算法（保留用于兼容性）\n    matchTemplate(frameData, template, frameWidth, frameHeight) {\n        return this.matchTemplateOptimized(frameData, template, frameWidth, frameHeight);\n    }\n\n    // 原始相似度计算（保留用于兼容性）\n    calculateSimilarity(frameData, templateData, frameX, frameY, frameWidth, \n                       templateX, templateY, templateWidth, width, height) {\n        return this.calculateSimilarityFast(frameData, templateData, frameX, frameY, frameWidth, \n                                          templateX, templateY, templateWidth, width, height);\n    }\n\n    // 简化的图片检测（基于颜色和形状特征）\n    detectSimple(ctx, width, height) {\n        try {\n            const imageData = ctx.getImageData(0, 0, width, height);\n            \n            // 寻找高对比度区域\n            const regions = this.findHighContrastRegions(imageData, width, height);\n            \n            for (const region of regions) {\n                if (this.isImageLike(region, imageData, width, height)) {\n                    return {\n                        detected: true,\n                        type: 'simple',\n                        position: { x: region.x, y: region.y },\n                        size: { width: region.width, height: region.height },\n                        confidence: 0.5\n                    };\n                }\n            }\n            \n            return { detected: false };\n            \n        } catch (error) {\n            console.error('简化检测错误:', error);\n            return { detected: false };\n        }\n    }\n\n    // 寻找高对比度区域\n    findHighContrastRegions(imageData, width, height) {\n        const regions = [];\n        const regionSize = 50;\n        const step = 25;\n        \n        for (let y = 0; y < height - regionSize; y += step) {\n            for (let x = 0; x < width - regionSize; x += step) {\n                const contrast = this.calculateRegionContrast(imageData, x, y, regionSize, width);\n                \n                if (contrast > 30) { // 降低对比度阈值\n                    regions.push({\n                        x, y, width: regionSize, height: regionSize, contrast\n                    });\n                }\n            }\n        }\n        \n        // 按对比度排序，返回前几个\n        return regions.sort((a, b) => b.contrast - a.contrast).slice(0, 3);\n    }\n\n    // 计算区域对比度\n    calculateRegionContrast(imageData, x, y, size, width) {\n        let minBrightness = 255;\n        let maxBrightness = 0;\n        \n        for (let dy = 0; dy < size; dy++) {\n            for (let dx = 0; dx < size; dx++) {\n                const index = ((y + dy) * width + (x + dx)) * 4;\n                const brightness = (imageData.data[index] + imageData.data[index + 1] + imageData.data[index + 2]) / 3;\n                \n                minBrightness = Math.min(minBrightness, brightness);\n                maxBrightness = Math.max(maxBrightness, brightness);\n            }\n        }\n        \n        return maxBrightness - minBrightness;\n    }\n\n    // 检查区域是否像图片\n    isImageLike(region, imageData, width, height) {\n        // 简单的图片特征检查\n        const edgeDensity = this.calculateEdgeDensity(imageData, region.x, region.y, region.width, region.height, width);\n        return edgeDensity > 0.1; // 边缘密度阈值\n    }\n\n    // 计算边缘密度\n    calculateEdgeDensity(imageData, x, y, w, h, width) {\n        let edgeCount = 0;\n        let totalPixels = 0;\n        \n        for (let dy = 1; dy < h - 1; dy++) {\n            for (let dx = 1; dx < w - 1; dx++) {\n                const index = ((y + dy) * width + (x + dx)) * 4;\n                const center = (imageData.data[index] + imageData.data[index + 1] + imageData.data[index + 2]) / 3;\n                \n                // 检查周围像素\n                const left = ((y + dy) * width + (x + dx - 1)) * 4;\n                const leftBrightness = (imageData.data[left] + imageData.data[left + 1] + imageData.data[left + 2]) / 3;\n                \n                if (Math.abs(center - leftBrightness) > 20) {\n                    edgeCount++;\n                }\n                \n                totalPixels++;\n            }\n        }\n        \n        return totalPixels > 0 ? edgeCount / totalPixels : 0;\n    }\n\n    // 清理资源\n    dispose() {\n        this.templates = [];\n        this.detectionCache.clear();\n        this.lastDetection = null;\n        console.log('图片追踪器资源已清理');\n    }\n} ","import { ARAnimation } from './ar-animation.js';\nimport { ImageTracker } from './image-tracker.js';\n\nconsole.log('AR应用开始加载...');\n\n// 快速启动模式配置\nconst FAST_START_CONFIG = {\n    // 快速启动：立即显示界面，后台加载资源\n    enableFastStart: true,\n    // 资源加载超时时间\n    resourceTimeout: 2000,\n    // 检测间隔（毫秒）\n    detectionInterval: 200,\n    // 简化检测模式\n    simpleDetection: true,\n    // 延迟初始化追踪器\n    delayTrackerInit: 500\n};\n\n// 检查基本功能\nfunction checkBasicFeatures() {\n    console.log('检查基本功能...');\n    \n    // 检查DOM是否加载完成\n    if (document.readyState === 'loading') {\n        console.log('DOM还在加载中...');\n        return false;\n    }\n    \n    // 检查必要的元素是否存在\n    const startARBtn = document.getElementById('startAR');\n    const startScreen = document.getElementById('startScreen');\n    const arScreen = document.getElementById('arScreen');\n    const loadingScreen = document.getElementById('loadingScreen');\n    \n    console.log('UI元素检查:', {\n        startARBtn: !!startARBtn,\n        startScreen: !!startScreen,\n        arScreen: !!arScreen,\n        loadingScreen: !!loadingScreen\n    });\n    \n    if (!startARBtn || !startScreen || !arScreen || !loadingScreen) {\n        console.error('必要的UI元素未找到！');\n        return false;\n    }\n    \n    return true;\n}\n\n// 优化的AR应用类\nclass OptimizedARApp {\n    constructor() {\n        console.log('初始化OptimizedARApp...');\n        this.isInitialized = false;\n        this.isTracking = false;\n        this.animation = null;\n        this.imageTracker = null;\n        this.detectionCanvas = null;\n        this.detectionCtx = null;\n        this.resourcesLoaded = false;\n        this.init();\n    }\n\n    init() {\n        console.log('开始快速初始化...');\n        \n        if (!checkBasicFeatures()) {\n            console.error('基本功能检查失败');\n            this.hideLoading();\n            this.showError('应用初始化失败：基本功能检查失败');\n            return;\n        }\n        \n        try {\n            this.initUI();\n            this.initEventListeners();\n            \n            // 快速启动：立即显示界面\n            if (FAST_START_CONFIG.enableFastStart) {\n                this.isInitialized = true;\n                this.hideLoading();\n                this.showStartScreen(); // 明确显示启动界面\n                console.log('快速启动完成，界面已显示');\n                \n                // 后台异步加载资源\n                this.loadResourcesInBackground();\n            } else {\n                // 传统模式：等待资源加载完成\n                this.initTrackersAsync();\n            }\n            \n        } catch (error) {\n            console.error('初始化过程中出错:', error);\n            this.hideLoading();\n            this.showError('应用初始化失败: ' + error.message);\n        }\n    }\n\n    initUI() {\n        console.log('初始化UI元素...');\n        this.startScreen = document.getElementById('startScreen');\n        this.arScreen = document.getElementById('arScreen');\n        this.loadingScreen = document.getElementById('loadingScreen');\n        this.startARBtn = document.getElementById('startAR');\n        this.backBtn = document.getElementById('backBtn');\n        this.captureBtn = document.getElementById('captureBtn');\n        this.status = document.getElementById('status');\n        this.video = document.getElementById('video');\n        this.canvas = document.getElementById('canvas');\n        \n        if (this.canvas) {\n            this.ctx = this.canvas.getContext('2d');\n        }\n        \n        // 创建检测用的canvas\n        this.detectionCanvas = document.createElement('canvas');\n        this.detectionCtx = this.detectionCanvas.getContext('2d');\n        \n        console.log('UI元素初始化完成');\n    }\n\n    async loadResourcesInBackground() {\n        console.log('后台加载资源...');\n        \n        try {\n            // 延迟初始化追踪器，减少启动时间\n            setTimeout(async () => {\n                await this.initTrackersAsync();\n            }, FAST_START_CONFIG.delayTrackerInit);\n            \n        } catch (error) {\n            console.error('后台资源加载失败:', error);\n        }\n    }\n\n    async initTrackersAsync() {\n        try {\n            console.log('开始异步初始化追踪器...');\n            \n            // 并行初始化核心组件\n            const [imageTracker, animation] = await Promise.allSettled([\n                this.createImageTracker(),\n                this.createAnimation()\n            ]);\n            \n            if (imageTracker.status === 'fulfilled') {\n                this.imageTracker = imageTracker.value;\n                console.log('图片追踪器初始化成功');\n            }\n            \n            if (animation.status === 'fulfilled') {\n                this.animation = animation.value;\n                console.log('动画组件初始化成功');\n            }\n            \n            this.resourcesLoaded = true;\n            console.log('AR组件初始化完成');\n            \n        } catch (error) {\n            console.error('追踪器初始化失败:', error);\n        }\n    }\n\n    async createImageTracker() {\n        const tracker = new ImageTracker();\n        \n        // 设置简化的检测模式\n        if (FAST_START_CONFIG.simpleDetection) {\n            tracker.detectionInterval = FAST_START_CONFIG.detectionInterval;\n            tracker.threshold = 0.15; // 降低阈值，提高检测灵敏度\n        }\n        \n        // 尝试加载marker，但不阻塞\n        try {\n            await tracker.addTemplate('/images/marker.png', 'marker');\n            console.log('Marker加载成功');\n        } catch (error) {\n            console.log('Marker加载失败，使用备用方案');\n            await this.addTestTemplate(tracker);\n        }\n        \n        return tracker;\n    }\n\n    async createAnimation() {\n        const animation = new ARAnimation();\n        \n        console.log('创建动画组件...');\n        \n        // 尝试加载PNG动画，但不阻塞\n        try {\n            await animation.loadFrames();\n            console.log('PNG动画加载成功');\n            console.log('动画状态:', {\n                isLoaded: animation.isLoaded,\n                frameCount: animation.frameCount,\n                framesLength: animation.frames.length,\n                fps: animation.fps\n            });\n        } catch (error) {\n            console.log('PNG动画加载失败:', error.message);\n            // 即使加载失败，也返回动画组件，避免主应用崩溃\n        }\n        \n        return animation;\n    }\n\n    async addTestTemplate(tracker) {\n        try {\n            // 创建一个简单的测试模板\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n            canvas.width = 80;\n            canvas.height = 80;\n            \n            // 绘制一个简单的测试图案\n            ctx.fillStyle = '#FFFFFF';\n            ctx.fillRect(0, 0, 80, 80);\n            ctx.strokeStyle = '#000000';\n            ctx.lineWidth = 2;\n            ctx.strokeRect(10, 10, 60, 60);\n            ctx.fillStyle = '#000000';\n            ctx.fillRect(25, 25, 30, 30);\n            \n            // 将canvas转换为blob URL\n            canvas.toBlob((blob) => {\n                const url = URL.createObjectURL(blob);\n                tracker.addTemplate(url, 'test-marker');\n                console.log('测试模板添加成功');\n            });\n            \n        } catch (error) {\n            console.error('添加测试模板失败:', error);\n        }\n    }\n\n    initEventListeners() {\n        console.log('初始化事件监听器...');\n        \n        if (this.startARBtn) {\n            this.startARBtn.addEventListener('click', () => this.startAR());\n        }\n        \n        if (this.backBtn) {\n            this.backBtn.addEventListener('click', () => this.stopAR());\n        }\n        \n        if (this.captureBtn) {\n            this.captureBtn.addEventListener('click', () => this.capturePhoto());\n        }\n        \n        console.log('事件监听器初始化完成');\n    }\n\n    async startAR() {\n        console.log('开始AR体验...');\n        console.log('当前状态:', {\n            isInitialized: this.isInitialized,\n            resourcesLoaded: this.resourcesLoaded,\n            hasImageTracker: !!this.imageTracker,\n            hasAnimation: !!this.animation\n        });\n        \n        // 放宽初始化检查，允许在资源未完全加载时启动\n        if (!this.isInitialized) {\n            console.log('应用未完全初始化，尝试继续启动...');\n            // 不阻止启动，而是继续尝试\n        }\n        \n        try {\n            this.showARScreen();\n            this.updateStatus('正在启动摄像头...');\n            \n            const cameraStarted = await this.requestCamera();\n            if (!cameraStarted) {\n                this.showError('无法启动摄像头，请检查权限设置');\n                return;\n            }\n            \n            this.updateStatus('摄像头已启动，等待视频加载...');\n            await this.waitForVideoLoad();\n            \n            // 如果追踪器还没准备好，等待一下\n            if (!this.imageTracker) {\n                this.updateStatus('正在准备图像识别...');\n                await this.waitForTracker();\n            }\n            \n            this.updateStatus('开始追踪marker...');\n            this.startTracking();\n            \n        } catch (error) {\n            console.error('启动AR失败:', error);\n            this.showError('启动AR失败: ' + error.message);\n        }\n    }\n\n    // 等待追踪器准备就绪\n    async waitForTracker() {\n        return new Promise((resolve) => {\n            const checkTracker = () => {\n                if (this.imageTracker) {\n                    resolve();\n                } else {\n                    setTimeout(checkTracker, 100);\n                }\n            };\n            checkTracker();\n        });\n    }\n\n    startTracking() {\n        if (this.isTracking) return;\n        \n        this.isTracking = true;\n        this.trackFrame();\n        console.log('开始追踪');\n    }\n\n    stopTracking() {\n        this.isTracking = false;\n        \n        if (this.animation) {\n            this.animation.stop();\n        }\n        \n        console.log('停止追踪');\n    }\n\n    trackFrame() {\n        if (!this.isTracking || !this.video || !this.canvas || !this.ctx) return;\n        \n        try {\n            // 绘制视频帧到canvas\n            this.ctx.drawImage(this.video, 0, 0, this.canvas.width, this.canvas.height);\n            \n            // 检测marker\n            this.detectMarker();\n            \n            // 继续下一帧\n            requestAnimationFrame(() => this.trackFrame());\n            \n        } catch (error) {\n            console.error('追踪帧处理错误:', error);\n            this.stopTracking();\n        }\n    }\n\n    async detectMarker() {\n        if (!this.imageTracker) {\n            console.log('图片追踪器未准备好，跳过检测');\n            return;\n        }\n        \n        if (!this.ctx) {\n            console.log('Canvas上下文未准备好，跳过检测');\n            return;\n        }\n        \n        try {\n            const detectionResult = await this.imageTracker.detect(\n                this.ctx, \n                this.canvas.width, \n                this.canvas.height\n            );\n            \n            if (detectionResult && detectionResult.detected) {\n                this.showAnimation(detectionResult);\n            } else {\n                this.hideAnimation();\n            }\n            \n        } catch (error) {\n            console.error('检测marker错误:', error);\n            // 不阻止继续检测\n        }\n    }\n\n    showAnimation(detectionResult) {\n        if (!this.animation) {\n            console.log('动画组件不存在，跳过显示');\n            return;\n        }\n        \n        if (!this.canvas) {\n            console.log('Canvas不存在，跳过显示');\n            return;\n        }\n        \n        if (!detectionResult || !detectionResult.position || !detectionResult.size) {\n            console.log('检测结果数据不完整，跳过显示');\n            return;\n        }\n        \n        try {\n            // 优化位置计算：显示在marker正上方\n            const position = {\n                x: detectionResult.position.x + detectionResult.size.width / 2,\n                y: detectionResult.position.y - detectionResult.size.height * 0.8 // 在marker上方，留一些间距\n            };\n            \n            // 优化尺寸计算：确保动画足够大且清晰\n            const size = {\n                width: Math.max(detectionResult.size.width * 1.5, 150), // 比marker大1.5倍，最小150px\n                height: Math.max(detectionResult.size.height * 1.5, 150)\n            };\n            \n            console.log('准备显示动画', {\n                position: position,\n                size: size,\n                animationLoaded: this.animation.isLoaded,\n                framesCount: this.animation.frames ? this.animation.frames.length : 0,\n                frameCount: this.animation.frameCount,\n                canvasSize: `${this.canvas.width}x${this.canvas.height}`\n            });\n            \n            this.animation.start(this.canvas, position, size);\n            this.updateStatus('检测到marker，显示动画');\n            \n        } catch (error) {\n            console.error('显示动画错误:', error);\n            this.updateStatus('动画显示失败: ' + error.message);\n        }\n    }\n\n    hideAnimation() {\n        if (this.animation) {\n            this.animation.stop();\n        }\n    }\n\n    async requestCamera() {\n        try {\n            const stream = await navigator.mediaDevices.getUserMedia({\n                video: {\n                    width: { ideal: 640 },\n                    height: { ideal: 480 },\n                    facingMode: 'environment' // 优先使用后置摄像头\n                }\n            });\n            \n            this.video.srcObject = stream;\n            this.video.play();\n            \n            console.log('摄像头启动成功');\n            return true;\n            \n        } catch (error) {\n            console.error('摄像头启动失败:', error);\n            return false;\n        }\n    }\n\n    waitForVideoLoad() {\n        return new Promise((resolve, reject) => {\n            const timeout = setTimeout(() => {\n                reject(new Error('视频加载超时'));\n            }, 5000);\n            \n            this.video.onloadedmetadata = () => {\n                clearTimeout(timeout);\n                \n                // 设置canvas尺寸\n                this.canvas.width = this.video.videoWidth;\n                this.canvas.height = this.video.videoHeight;\n                \n                console.log('视频加载完成');\n                resolve();\n            };\n            \n            this.video.onerror = (error) => {\n                clearTimeout(timeout);\n                reject(new Error('视频加载失败'));\n            };\n        });\n    }\n\n    stopAR() {\n        console.log('停止AR体验...');\n        \n        this.stopTracking();\n        \n        // 停止摄像头\n        if (this.video && this.video.srcObject) {\n            const tracks = this.video.srcObject.getTracks();\n            tracks.forEach(track => track.stop());\n            this.video.srcObject = null;\n        }\n        \n        this.showStartScreen();\n        this.updateStatus('AR体验已停止');\n    }\n\n    capturePhoto() {\n        if (!this.canvas) return;\n        \n        try {\n            // 创建拍照canvas\n            const photoCanvas = document.createElement('canvas');\n            const photoCtx = photoCanvas.getContext('2d');\n            \n            photoCanvas.width = this.canvas.width;\n            photoCanvas.height = this.canvas.height;\n            \n            // 绘制当前帧\n            photoCtx.drawImage(this.canvas, 0, 0);\n            \n            // 转换为图片\n            const photoDataUrl = photoCanvas.toDataURL('image/png');\n            \n            // 创建下载链接\n            const link = document.createElement('a');\n            link.download = `ar-photo-${Date.now()}.png`;\n            link.href = photoDataUrl;\n            link.click();\n            \n            this.updateStatus('照片已保存');\n            console.log('照片已保存');\n            \n        } catch (error) {\n            console.error('拍照失败:', error);\n            this.updateStatus('拍照失败');\n        }\n    }\n\n    showLoading() {\n        if (this.loadingScreen) {\n            this.loadingScreen.style.display = 'flex';\n        }\n        if (this.startScreen) {\n            this.startScreen.style.display = 'none';\n        }\n        if (this.arScreen) {\n            this.arScreen.style.display = 'none';\n        }\n    }\n\n    hideLoading() {\n        if (this.loadingScreen) {\n            this.loadingScreen.style.display = 'none';\n        }\n    }\n\n    showStartScreen() {\n        if (this.startScreen) {\n            this.startScreen.style.display = 'flex';\n        }\n        if (this.arScreen) {\n            this.arScreen.style.display = 'none';\n        }\n        if (this.loadingScreen) {\n            this.loadingScreen.style.display = 'none';\n        }\n    }\n\n    showARScreen() {\n        if (this.arScreen) {\n            this.arScreen.style.display = 'flex';\n        }\n        if (this.startScreen) {\n            this.startScreen.style.display = 'none';\n        }\n        if (this.loadingScreen) {\n            this.loadingScreen.style.display = 'none';\n        }\n    }\n\n    updateStatus(message) {\n        if (this.status) {\n            this.status.textContent = message;\n        }\n        console.log('状态更新:', message);\n    }\n\n    showError(message) {\n        console.error('错误:', message);\n        this.updateStatus('错误: ' + message);\n        \n        // 3秒后清除错误信息\n        setTimeout(() => {\n            this.updateStatus('');\n        }, 3000);\n    }\n}\n\n// 初始化应用\nfunction initApp() {\n    console.log('开始初始化AR应用...');\n    \n    // 检查浏览器兼容性\n    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n        alert('您的浏览器不支持摄像头功能，请使用现代浏览器');\n        return;\n    }\n    \n    // 创建应用实例\n    window.arApp = new OptimizedARApp();\n}\n\n// 等待DOM加载完成后初始化\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', initApp);\n} else {\n    initApp();\n} "],"names":["ARAnimation","canvas","position","size","currentTime","frame","drawInfo","cacheKey","centerX","centerY","minSize","maxSize","frameWidth","frameHeight","scale","drawWidth","drawHeight","drawX","drawY","viewportWidth","viewportHeight","finalX","finalY","resolve","reject","framePaths","loadedCount","errorCount","totalFrames","overallTimeout","path","index","img","timeout","error","gifPath","ImageTracker","imageUrl","name","ctx","imageData","width","height","now","cachedResult","frameData","template","match","result","noDetectionResult","templateWidth","templateHeight","bestMatch","bestConfidence","step","searchMargin","startX","startY","endX","endY","maxSamples","sampleCount","y","x","confidence","templateData","frameX","frameY","templateX","templateY","totalDiff","totalPixels","sampleStep","frameIndex","templateIndex","rDiff","gDiff","bDiff","averageDiff","regions","region","contrast","b","minBrightness","maxBrightness","dy","dx","brightness","w","h","edgeCount","center","left","leftBrightness","FAST_START_CONFIG","checkBasicFeatures","startARBtn","startScreen","arScreen","loadingScreen","OptimizedARApp","imageTracker","animation","tracker","blob","url","checkTracker","detectionResult","stream","track","photoCanvas","photoCtx","photoDataUrl","link","message","initApp"],"mappings":"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"}